<div class="container py-5">
  <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
    <h1 class="h4 mb-0">Gallery</h1>

    <div class="d-flex flex-wrap gap-2">
      <div class="input-group rounded-pill border overflow-hidden" style="max-width: 260px;">
        <span class="input-group-text bg-white border-0"><i class="bi bi-search"></i></span>
        <input type="search" class="form-control border-0" [(ngModel)]="q" placeholder="Searchâ€¦">
      </div>
      <button class="btn btn-outline-secondary rounded-pill" (click)="clearFilters()">Clear</button>
    </div>
  </div>

  <!-- Filters -->
  <div class="d-flex flex-wrap gap-2 mb-4">
    <button
      *ngFor="let c of categories"
      class="btn btn-sm rounded-pill"
      [class.btn-dark]="active.has(c)"
      [class.btn-outline-secondary]="!active.has(c)"
      (click)="toggleTag(c)">
      {{ c }}
    </button>
  </div>

  <!-- Masonry-like grid -->
  <div class="gallery-grid">
    <figure
      class="gallery-item"
      *ngFor="let img of filtered; let i = index"
      (click)="open(i)"
      role="button"
      [attr.aria-label]="img.alt">
      <img
        [src]="img.src"
        [alt]="img.alt"
        loading="lazy"
        class="w-100 h-100 object-fit-cover rounded-3 shadow-sm">
      <figcaption class="small text-muted">
        {{ img.alt }}
      </figcaption>
    </figure>
  </div>

  <!-- Lightbox Modal -->
  <div class="modal fade" id="lightbox" tabindex="-1" aria-hidden="true" (hidden.bs.modal)="showModal=false">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content border-0 bg-dark">
        <button type="button" class="btn-close btn-close-white position-absolute end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>

        <div class="modal-body p-0">
          <div class="ratio ratio-16x9">
            <img [src]="filtered[activeIndex]?.src" [alt]="filtered[activeIndex]?.alt" class="w-100 h-100 object-fit-contain">
          </div>
          <div class="d-flex justify-content-between align-items-center px-3 py-2 text-white small">
            <button class="btn btn-sm btn-light rounded-pill" (click)="prev()">
              <i class="bi bi-chevron-left"></i> Prev
            </button>
            <div class="text-truncate">{{ filtered[activeIndex]?.alt }}</div>
            <button class="btn btn-sm btn-light rounded-pill" (click)="next()">
              Next <i class="bi bi-chevron-right"></i>
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
